package component:mitm-plugin;

world mitm-plugin {
  import wasi:logging/logging;
  import wasi:keyvalue/store;
  import wasi:http/outgoing-handler;
  import wasi:clocks/wall-clock;
  
  // Plugin-specific exports
  export get-metadata: func() -> string;
  export on-request: func(context: string) -> string;
  export on-response: func(context: string) -> string;
  export on-request-body: func(context: string, body: list<u8>) -> string;
  export on-response-body: func(context: string, body: list<u8>) -> string;
  export on-request-html: func(context: string, html: string) -> string;
  export on-response-html: func(context: string, html: string) -> string;
  export on-request-json: func(context: string, json: string) -> string;
  export on-response-json: func(context: string, json: string) -> string;
}